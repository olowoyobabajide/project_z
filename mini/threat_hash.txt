get the file size 
create buffer of file size
fseek to the beginning of the file
fread the file of buffer size
now use the hash types(md5, sha1, sha256 to check the hash)
compare that hash with the threat db

Understanding OpenSSL's EVP Interface for MD5 Hashing

OpenSSL's evp.h header file provides a high-level interface for cryptographic functions, including hashing algorithms. When creating an MD5 hash, a series of functions from this interface are used in a specific sequence to initialize the process, supply the data to be hashed, and finalize the computation to retrieve the resulting hash. Below is an explanation of the key functions involved in this process.

EVP_md5: The Hashing Algorithm Identifier

The EVP_md5() function serves as an identifier for the MD5 hashing algorithm within the EVP interface.[1][2] It does not take any parameters and returns a constant pointer to an EVP_MD structure. This structure contains the implementation details of the MD5 algorithm, such as its block size and output size.[1] You pass this returned structure to other EVP functions to specify that you want to use the MD5 algorithm for the hashing operation.

It is important to note that the MD5 algorithm is considered cryptographically broken and should not be used for security-sensitive applications.[1][2]

EVP_DigestInit_ex: Initializing the Hashing Process

The EVP_DigestInit_ex() function initializes a hashing context for a new digest operation. A hashing context is a structure that holds the intermediate values during the hashing process.

Function Signature:
int EVP_DigestInit_ex(EVP_MD_CTX *ctx, const EVP_MD *type, ENGINE *impl);

Parameters:

EVP_MD_CTX *ctx: A pointer to an EVP_MD_CTX structure, which is the context that will be initialized. This structure must be allocated before calling this function.

const EVP_MD *type: A pointer to the EVP_MD structure that defines the hashing algorithm to be used. In the case of MD5, this would be the value returned by EVP_md5().

ENGINE *impl: This parameter is typically set to NULL to use the default implementation of the chosen algorithm.[3]

A successful call to this function readies the context for receiving the data that needs to be hashed.

EVP_DigestUpdate: Hashing the Data

Once the context is initialized, the EVP_DigestUpdate() function is used to feed the data to be hashed into the algorithm. This function can be called multiple times to hash data in chunks.

Function Signature:
int EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *d, size_t cnt);

Parameters:

EVP_MD_CTX *ctx: The hashing context that was initialized by EVP_DigestInit_ex().

const void *d: A pointer to the data to be hashed.

size_t cnt: The length of the data in bytes.[3]

Each call to EVP_DigestUpdate() processes the provided data and updates the internal state of the hashing context.

EVP_MD_get_size: Retrieving the Hash Size

The EVP_MD_get_size() function is used to determine the size of the resulting hash in bytes for a given hashing algorithm.

Function Signature:
int EVP_MD_get_size(const EVP_MD *md);

Parameters:

const EVP_MD *md: A pointer to the EVP_MD structure representing the hashing algorithm (e.g., the return value of EVP_md5()).

For MD5, this function will return 16, as an MD5 hash is 128 bits (16 bytes) long. This function is useful for allocating the correct amount of memory to store the final hash.

EVP_DigestFinal_ex: Finalizing and Retrieving the Hash

After all the data has been processed with EVP_DigestUpdate(), the EVP_DigestFinal_ex() function is called to finalize the hashing process and retrieve the computed hash.

Function Signature:
int EVP_DigestFinal_ex(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *s);

Parameters:

EVP_MD_CTX *ctx: The hashing context that has been used to process the data.

unsigned char *md: A pointer to a buffer where the resulting hash will be stored. The buffer should be large enough to hold the hash (e.g., 16 bytes for MD5).

unsigned int *s: A pointer to an unsigned integer where the size of the hash in bytes will be written.[4][5]

Once EVP_DigestFinal_ex() has been called, the hashing context is finalized. No further calls to EVP_DigestUpdate() can be made without re-initializing the context with EVP_DigestInit_ex().[3][5]

In summary, creating an MD5 hash using the OpenSSL EVP interface involves a clear sequence of steps: obtaining the algorithm identifier with EVP_md5(), initializing a context with EVP_DigestInit_ex(), hashing the data with one or more calls to EVP_DigestUpdate(), and finally, retrieving the hash with EVP_DigestFinal_ex(). The EVP_MD_get_size() function can be used to determine the appropriate buffer size for the resulting hash.

Sources
help
openssl.org
openssl.org
sortix.org
debian.org
sortix.org
Google Search Suggestions
Display of Search Suggestions is required when using Grounding with Google Search. Learn more
openssl evp.h EVP_md5 function
openssl evp.h EVP_DigestInit_ex function
openssl evp.h EVP_DigestUpdate function
openssl evp.h EVP_DigestFinal_ex function
openssl evp.h EVP_MD_get_size function


working on the logging
Each major function should have a main log
create another function that appends sub fields
Repeat for each process

extras, but important:
Also work on the permission bug
reducing false positives for dex too
